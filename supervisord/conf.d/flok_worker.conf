[program:flok_worker]
process_name=%(program_name)s_%(process_num)02d
command=php /var/www/artisan queue:listen
autostart=true
autorestart=true
user=www
numprocs=5
redirect_stderr=true
stdout_logfile=/var/www/flok_worker.out.log
stderr_logfile=/var/www/flok_worker.err.log
stdout_logfile_maxbytes=0

[program:flok_media_worker]
process_name=%(program_name)s_%(process_num)02d
command=php /var/www/artisan queue:listen redis_local --tries=1 --timeout=7200 --memory=2000
autostart=true
autorestart=true
user=www
numprocs=5
redirect_stderr=true
stdout_logfile=/var/www/flok_media_worker.out.log
stderr_logfile=/var/www/flok_media_worker.err.log
stdout_logfile_maxbytes=0

[program:php-fpm]
command=php-fpm -F
autostart=true
autorestart=unexpected
stdout_logfile=/var/www/php-fpm_stdout.log
stdout_logfile_maxbytes=0
stderr_logfile=/var/www/php-fpm_stderr.log
stderr_logfile_maxbytes=0
exitcodes=0

[program:websocket-server]
command=php /var/www/artisan flok:start-websocket
autostart=true
autorestart=true
stdout_logfile=/var/www/websocket_stdout.log
stdout_logfile_maxbytes=0
stderr_logfile=/var/www/websocket_stderr.log
stderr_logfile_maxbytes=0
exitcodes=0

[program:websocket-subscriber]
command=php /var/www/artisan flok:start-websocket-subscriber
autostart=true
autorestart=true
stdout_logfile=/var/www/websocket_subscriber_stdout.log
stdout_logfile_maxbytes=0
stderr_logfile=/var/www/websocket_subscriber_stderr.log
stderr_logfile_maxbytes=0
exitcodes=0

[program:nginx]
priority=10
autostart=true
autorestart=true
stderr_logfile_maxbytes=0
stdout_logfile_maxbytes=0
stdout_events_enabled=true
stderr_events_enabled=true
command=/usr/sbin/nginx -g 'daemon off;'
stderr_logfile=/var/log/nginx/error.log
stdout_logfile=/var/log/nginx/access.log

[program:laravel-schedule]
numprocs=1
autostart=true
autorestart=true
redirect_stderr=true
process_name=%(program_name)s_%(process_num)02d
command=php /var/www/artisan schedule:run
stdout_logfile=/var/log/nginx/schedule.log